<views:MvxWpfView x:Class="Storix.Presentation.Details.OrderDetails"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                  xmlns:loadingSpinnerControl="clr-namespace:LoadingSpinnerControl;assembly=LoadingSpinnerControl"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:orders="clr-namespace:Storix.Core.ViewModels.Orders;assembly=Storix.Core"
                  xmlns:views="clr-namespace:MvvmCross.Platforms.Wpf.Views;assembly=MvvmCross.Platforms.Wpf"
                  d:DataContext="{d:DesignInstance Type=orders:OrderDetailsViewModelBase,
                                                   IsDesignTimeCreatable=False}"
                  d:DesignHeight="auto"
                  d:DesignWidth="900"
                  mc:Ignorable="d">
    <Border Padding="30"
            Background="{DynamicResource PrimaryBackgroundColor}"
            BorderBrush="{DynamicResource SecondaryBorderColor}"
            BorderThickness="1"
            CornerRadius="12">
        <Grid>
            <!--  Loading Overlay  -->
            <StackPanel HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Visibility="{Binding IsLoading, Converter={StaticResource ToVisibilityConverter}}">
                <loadingSpinnerControl:LoadingSpinner Diameter="80"
                                                      IsLoading="{Binding IsLoading}"
                                                      Thickness="3" />
                <TextBlock Margin="0,10"
                           FontFamily="Californian FB"
                           FontSize="14"
                           Foreground="{DynamicResource SecondaryTextColor}"
                           Text="Loading order details..."
                           TextAlignment="Center" />
            </StackPanel>

            <!--  Main Content  -->
            <Grid Visibility="{Binding IsLoading, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Header Section  -->
                <Border Grid.Row="0"
                        Margin="0,0,0,20"
                        Padding="20"
                        Background="{DynamicResource CardBackgroundColor}"
                        BorderBrush="{DynamicResource PrimaryBorderColor}"
                        BorderThickness="2"
                        CornerRadius="12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <StackPanel Orientation="Horizontal">
                                <iconPacks:PackIconMaterial Width="32" Height="32">
                                    <iconPacks:PackIconMaterial.Style>
                                        <Style TargetType="iconPacks:PackIconMaterial">
                                            <Setter Property="Kind" Value="ReceiptTextOutline" />
                                            <Setter Property="Foreground" Value="#3B82F6" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsPurchaseOrder}" Value="True">
                                                    <Setter Property="Kind" Value="CartOutline" />
                                                    <Setter Property="Foreground" Value="#10B981" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </iconPacks:PackIconMaterial.Style>
                                </iconPacks:PackIconMaterial>
                                <TextBlock Margin="12,0,0,0"
                                           VerticalAlignment="Center"
                                           FontFamily="Californian FB"
                                           FontSize="24"
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryTextColor}">
                                    <Run Text="{Binding OrderTypeDisplay, Mode=OneWay}" />
                                    <Run Text=" Order #" />
                                    <Run Text="{Binding Order.OrderId, Mode=OneWay}" />
                                </TextBlock>
                            </StackPanel>
                            <TextBlock Margin="44,5,0,0"
                                       FontSize="13"
                                       Foreground="{DynamicResource SecondaryTextColor}"
                                       Text="Complete order information and status management"
                                       TextWrapping="Wrap" />
                        </StackPanel>

                        <!--  Status Badge  -->
                        <Border Grid.Column="1"
                                Padding="20,10"
                                VerticalAlignment="Center"
                                Background="{Binding StatusColor}"
                                CornerRadius="8">
                            <StackPanel>
                                <TextBlock HorizontalAlignment="Center"
                                           FontSize="11"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           Opacity="0.8"
                                           Text="STATUS" />
                                <TextBlock Margin="0,4,0,0"
                                           HorizontalAlignment="Center"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           Text="{Binding StatusDisplay}" />
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!--  Content  -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!--  Order Information Card  -->
                        <Border Padding="20"
                                Background="{DynamicResource CardBackgroundColor}"
                                BorderBrush="{DynamicResource SecondaryBorderColor}"
                                BorderThickness="1"
                                CornerRadius="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <!--  Order Header Info  -->
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <!--  Customer/Supplier  -->
                                    <StackPanel Grid.Row="0"
                                                Grid.Column="0"
                                                Margin="0,0,10,20">
                                        <TextBlock FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}">
                                            <Run Text="👤 " />
                                            <Run Text="{Binding OrderEntityName, Mode=OneWay}" />
                                        </TextBlock>
                                        <TextBlock Margin="0,6,0,0"
                                                   FontSize="18"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding EntityName}" />
                                    </StackPanel>

                                    <!--  Location  -->
                                    <StackPanel Grid.Row="0"
                                                Grid.Column="1"
                                                Margin="10,0,0,20">
                                        <TextBlock FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="📍 LOCATION" />
                                        <TextBlock Margin="0,6,0,0"
                                                   FontSize="18"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding LocationName}" />
                                    </StackPanel>

                                    <!--  Order Date  -->
                                    <StackPanel Grid.Row="1"
                                                Grid.Column="0"
                                                Margin="0,0,10,20">
                                        <TextBlock FontSize="11"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="📅 ORDER DATE" />
                                        <TextBlock Margin="0,4,0,0"
                                                   FontSize="16"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding Order.OrderDate, StringFormat='MMM dd, yyyy'}" />
                                    </StackPanel>

                                    <!--  Delivery Date  -->
                                    <StackPanel Grid.Row="1"
                                                Grid.Column="1"
                                                Margin="10,0,0,20"
                                                Visibility="{Binding HasDeliveryDate, Converter={StaticResource ToVisibilityConverter}}">
                                        <TextBlock FontSize="11"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="🚚 DELIVERY DATE" />
                                        <TextBlock Margin="0,4,0,0"
                                                   FontSize="16"
                                                   FontWeight="SemiBold"
                                                   Foreground="#10B981"
                                                   Text="{Binding Order.DeliveryDate, StringFormat='MMM dd, yyyy'}" />
                                    </StackPanel>

                                    <!--  Created By  -->
                                    <StackPanel Grid.Row="2"
                                                Grid.Column="0"
                                                Margin="0,0,10,0">
                                        <TextBlock FontSize="11"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="👨‍💼 CREATED BY" />
                                        <TextBlock Margin="0,4,0,0"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding CreatedByName}" />
                                    </StackPanel>

                                    <!--  Order Type  -->
                                    <StackPanel Grid.Row="2"
                                                Grid.Column="1"
                                                Margin="10,0,0,0">
                                        <TextBlock FontSize="11"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="📦 ORDER TYPE" />
                                        <Border Margin="0,4,0,0"
                                                Padding="10,5"
                                                HorizontalAlignment="Left"
                                                CornerRadius="6">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="#DBEAFE" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsPurchaseOrder}" Value="True">
                                                            <Setter Property="Background" Value="#D1FAE5" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <TextBlock FontSize="14" FontWeight="Bold">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#1E40AF" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsPurchaseOrder}" Value="True">
                                                                <Setter Property="Foreground" Value="#065F46" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                                <Run Text="{Binding Order.Type, Mode=OneWay}" />
                                            </TextBlock>
                                        </Border>
                                    </StackPanel>
                                </Grid>

                                <!--  Notes  -->
                                <Border Grid.Row="1"
                                        Margin="0,20,0,0"
                                        Padding="15"
                                        Background="{DynamicResource InfoBackgroundColor}"
                                        BorderBrush="{DynamicResource InfoBorderColor}"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        Visibility="{Binding HasNotes, Converter={StaticResource ToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="📝 ORDER NOTES" />
                                        <TextBlock Margin="0,6,0,0"
                                                   FontSize="13"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding Order.Notes}"
                                                   TextWrapping="Wrap" />
                                    </StackPanel>
                                </Border>

                                <!--  Status Management Section  -->
                                <Border Grid.Row="2"
                                        Margin="0,20,0,0"
                                        Padding="20"
                                        Background="#F1F5F9"
                                        BorderBrush="#CBD5E1"
                                        BorderThickness="1"
                                        CornerRadius="8">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <iconPacks:PackIconMaterial Width="20"
                                                                        Height="20"
                                                                        Foreground="#3B82F6"
                                                                        Kind="ClipboardCheckOutline" />
                                            <TextBlock Margin="10,0,0,0"
                                                       VerticalAlignment="Center"
                                                       FontSize="16"
                                                       FontWeight="Bold"
                                                       Foreground="{DynamicResource PrimaryTextColor}"
                                                       Text="Change Order Status" />
                                        </StackPanel>

                                        <TextBlock Margin="0,10,0,15"
                                                   FontSize="12"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="Select a new status to update this order"
                                                   TextWrapping="Wrap" />

                                        <!--  Status Buttons Grid  -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="10" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!--  Draft Status  -->
                                            <Button Grid.Row="0"
                                                    Grid.Column="0"
                                                    Height="80"
                                                    Command="{Binding ChangeStatusCommand}"
                                                    CommandParameter="Draft">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource OpenBtn}" TargetType="Button">
                                                        <Setter Property="Background" Value="#FFFBEB" />
                                                        <Setter Property="BorderBrush" Value="#F59E0B" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding CurrentStatus}" Value="Draft">
                                                                <Setter Property="Background" Value="#FEF3C7" />
                                                                <Setter Property="BorderThickness" Value="3" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#FEF3C7" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel>
                                                    <iconPacks:PackIconMaterial Width="24"
                                                                                Height="24"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="#F59E0B"
                                                                                Kind="FileDocumentEditOutline" />
                                                    <TextBlock Margin="0,8,0,0"
                                                               HorizontalAlignment="Center"
                                                               FontSize="13"
                                                               FontWeight="Bold"
                                                               Foreground="#92400E"
                                                               Text="Draft" />
                                                </StackPanel>
                                            </Button>

                                            <!--  Active Status  -->
                                            <Button Grid.Row="0"
                                                    Grid.Column="2"
                                                    Height="80"
                                                    Command="{Binding ChangeStatusCommand}"
                                                    CommandParameter="Active"
                                                    Visibility="{Binding CanChangeToActive, Converter={StaticResource ToVisibilityConverter}}">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource OpenBtn}" TargetType="Button">
                                                        <Setter Property="Background" Value="#EFF6FF" />
                                                        <Setter Property="BorderBrush" Value="#3B82F6" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding CurrentStatus}" Value="Active">
                                                                <Setter Property="Background" Value="#DBEAFE" />
                                                                <Setter Property="BorderThickness" Value="3" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#DBEAFE" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel>
                                                    <iconPacks:PackIconMaterial Width="24"
                                                                                Height="24"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="#3B82F6"
                                                                                Kind="PlayCircleOutline" />
                                                    <TextBlock Margin="0,8,0,0"
                                                               HorizontalAlignment="Center"
                                                               FontSize="13"
                                                               FontWeight="Bold"
                                                               Foreground="#1E40AF"
                                                               Text="Active" />
                                                </StackPanel>
                                            </Button>

                                            <!--  Fulfilled Status  -->
                                            <Button Grid.Row="0"
                                                    Grid.Column="4"
                                                    Height="80"
                                                    Command="{Binding ChangeStatusCommand}"
                                                    CommandParameter="Fulfilled"
                                                    Visibility="{Binding CanChangeToFulfilled, Converter={StaticResource ToVisibilityConverter}}">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource OpenBtn}" TargetType="Button">
                                                        <Setter Property="Background" Value="#F3E8FF" />
                                                        <Setter Property="BorderBrush" Value="#8B5CF6" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding CurrentStatus}" Value="Fulfilled">
                                                                <Setter Property="Background" Value="#EDE9FE" />
                                                                <Setter Property="BorderThickness" Value="3" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#EDE9FE" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel>
                                                    <iconPacks:PackIconMaterial Width="24"
                                                                                Height="24"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="#8B5CF6"
                                                                                Kind="PackageVariantClosed" />
                                                    <TextBlock Margin="0,8,0,0"
                                                               HorizontalAlignment="Center"
                                                               FontSize="13"
                                                               FontWeight="Bold"
                                                               Foreground="#6B21A8"
                                                               Text="Fulfilled" />
                                                </StackPanel>
                                            </Button>

                                            <!--  Completed Status  -->
                                            <Button Grid.Row="2"
                                                    Grid.Column="0"
                                                    Height="80"
                                                    Command="{Binding ChangeStatusCommand}"
                                                    CommandParameter="Completed"
                                                    Visibility="{Binding CanChangeToCompleted, Converter={StaticResource ToVisibilityConverter}}">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource OpenBtn}" TargetType="Button">
                                                        <Setter Property="Background" Value="#ECFDF5" />
                                                        <Setter Property="BorderBrush" Value="#10B981" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding CurrentStatus}" Value="Completed">
                                                                <Setter Property="Background" Value="#D1FAE5" />
                                                                <Setter Property="BorderThickness" Value="3" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#D1FAE5" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel>
                                                    <iconPacks:PackIconMaterial Width="24"
                                                                                Height="24"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="#10B981"
                                                                                Kind="CheckCircleOutline" />
                                                    <TextBlock Margin="0,8,0,0"
                                                               HorizontalAlignment="Center"
                                                               FontSize="13"
                                                               FontWeight="Bold"
                                                               Foreground="#065F46"
                                                               Text="Completed" />
                                                </StackPanel>
                                            </Button>

                                            <!--  Cancelled Status  -->
                                            <Button Grid.Row="2"
                                                    Grid.Column="2"
                                                    Grid.ColumnSpan="3"
                                                    Height="80"
                                                    Command="{Binding ChangeStatusCommand}"
                                                    CommandParameter="Cancelled"
                                                    Visibility="{Binding CanChangeToCancelled, Converter={StaticResource ToVisibilityConverter}}">
                                                <Button.Style>
                                                    <Style BasedOn="{StaticResource OpenBtn}" TargetType="Button">
                                                        <Setter Property="Background" Value="#FEF2F2" />
                                                        <Setter Property="BorderBrush" Value="#EF4444" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding CurrentStatus}" Value="Cancelled">
                                                                <Setter Property="Background" Value="#FEE2E2" />
                                                                <Setter Property="BorderThickness" Value="3" />
                                                            </DataTrigger>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#FEE2E2" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel>
                                                    <iconPacks:PackIconMaterial Width="24"
                                                                                Height="24"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="#EF4444"
                                                                                Kind="CloseCircleOutline" />
                                                    <TextBlock Margin="0,8,0,0"
                                                               HorizontalAlignment="Center"
                                                               FontSize="13"
                                                               FontWeight="Bold"
                                                               Foreground="#991B1B"
                                                               Text="Cancelled" />
                                                </StackPanel>
                                            </Button>
                                        </Grid>

                                        <!--  Status Help Text  -->
                                        <Border Margin="0,15,0,0"
                                                Padding="12"
                                                Background="White"
                                                BorderBrush="#CBD5E1"
                                                BorderThickness="1"
                                                CornerRadius="6">
                                            <TextBlock FontSize="11"
                                                       Foreground="{DynamicResource SecondaryTextColor}"
                                                       TextWrapping="Wrap">
                                                <Run FontWeight="Bold" Text="Status Guidelines:" />
                                                <LineBreak />
                                                <Run Text="• Draft: Order being created/edited" />
                                                <LineBreak />
                                                <Run Text="• Active: Order approved and in progress (stock reserved for sales)" />
                                                <LineBreak />
                                                <Run Text="• Fulfilled: Ready for inventory update (goods received/shipped)" />
                                                <LineBreak />
                                                <Run Text="• Completed: Order fully closed" />
                                                <LineBreak />
                                                <Run Text="• Cancelled: Order cancelled (reserved stock released)" />
                                            </TextBlock>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Border>

                        <!--  Order Items Section  -->
                        <Border Margin="0,20,0,0"
                                Padding="20"
                                Background="{DynamicResource CardBackgroundColor}"
                                BorderBrush="{DynamicResource SecondaryBorderColor}"
                                BorderThickness="1"
                                CornerRadius="8">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <iconPacks:PackIconMaterial Width="22"
                                                                Height="22"
                                                                Foreground="#F59E0B"
                                                                Kind="FormatListBulleted" />
                                    <TextBlock Margin="10,0,0,0"
                                               VerticalAlignment="Center"
                                               FontSize="18"
                                               FontWeight="Bold"
                                               Foreground="{DynamicResource PrimaryTextColor}"
                                               Text="Order Items" />
                                    <TextBlock Margin="10,0,0,0"
                                               VerticalAlignment="Center"
                                               FontSize="14"
                                               Foreground="{DynamicResource SecondaryTextColor}">
                                        <Run Text="(" /><Run Text="{Binding TotalItems, Mode=OneWay}" />
                                        <Run Text=" items)" />
                                    </TextBlock>
                                </StackPanel>

                                <!--  Order Items DataGrid  -->
                                <Border Margin="0,15,0,0"
                                        Background="White"
                                        BorderBrush="{DynamicResource SecondaryBorderColor}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Visibility="{Binding HasOrderItems, Converter={StaticResource ToVisibilityConverter}}">
                                    <DataGrid AutoGenerateColumns="False"
                                              Background="Transparent"
                                              BorderThickness="0"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              CanUserReorderColumns="False"
                                              CanUserResizeRows="False"
                                              GridLinesVisibility="Horizontal"
                                              HeadersVisibility="Column"
                                              IsReadOnly="True"
                                              ItemsSource="{Binding OrderItems}"
                                              RowHeight="60"
                                              SelectionMode="Single">

                                        <!--  DataGrid Style  -->
                                        <DataGrid.Style>
                                            <Style TargetType="DataGrid">
                                                <Setter Property="BorderThickness" Value="0" />
                                                <Setter Property="Background" Value="Transparent" />
                                                <Setter Property="HorizontalGridLinesBrush" Value="#E2E8F0" />
                                            </Style>
                                        </DataGrid.Style>

                                        <!--  Column Header Style  -->
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="#F8FAFC" />
                                                <Setter Property="Foreground" Value="#64748B" />
                                                <Setter Property="FontWeight" Value="Bold" />
                                                <Setter Property="FontSize" Value="12" />
                                                <Setter Property="Padding" Value="15,12" />
                                                <Setter Property="BorderThickness" Value="0,0,0,2" />
                                                <Setter Property="BorderBrush" Value="#E2E8F0" />
                                                <Setter Property="HorizontalContentAlignment" Value="Left" />
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>

                                        <!--  Row Style  -->
                                        <DataGrid.RowStyle>
                                            <Style TargetType="DataGridRow">
                                                <Setter Property="Background" Value="White" />
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#F8FAFC" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGrid.RowStyle>

                                        <!--  Cell Style  -->
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="BorderThickness" Value="0" />
                                                <Setter Property="Padding" Value="15,10" />
                                                <Setter Property="Background" Value="Transparent" />
                                                <Setter Property="Foreground" Value="{DynamicResource PrimaryTextColor}" />
                                                <Style.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="Background" Value="Transparent" />
                                                        <Setter Property="Foreground" Value="{DynamicResource PrimaryTextColor}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGrid.CellStyle>

                                        <!--  Columns  -->
                                        <DataGrid.Columns>
                                            <!--  Item # Column  -->
                                            <DataGridTextColumn Width="60"
                                                                Binding="{Binding ItemNumber}"
                                                                Header="#">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="FontWeight" Value="SemiBold" />
                                                        <Setter Property="FontSize" Value="13" />
                                                        <Setter Property="Foreground" Value="#64748B" />
                                                        <Setter Property="VerticalAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>

                                            <!--  Product Name Column  -->
                                            <DataGridTemplateColumn Width="*" Header="PRODUCT">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel VerticalAlignment="Center">
                                                            <TextBlock FontSize="14"
                                                                       FontWeight="SemiBold"
                                                                       Foreground="{DynamicResource PrimaryTextColor}"
                                                                       Text="{Binding ProductName}" />
                                                            <TextBlock Margin="0,3,0,0"
                                                                       FontSize="11"
                                                                       Foreground="{DynamicResource SecondaryTextColor}"
                                                                       Text="{Binding ProductSKU}"
                                                                       Visibility="{Binding HasSKU, Converter={StaticResource ToVisibilityConverter}}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <!--  Quantity Column  -->
                                            <DataGridTemplateColumn Width="120" Header="QUANTITY">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Border Padding="10,6"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center"
                                                                Background="#EFF6FF"
                                                                CornerRadius="6">
                                                            <TextBlock FontSize="14"
                                                                       FontWeight="Bold"
                                                                       Foreground="#1E40AF"
                                                                       Text="{Binding Quantity, StringFormat='{}{0:N0}'}" />
                                                        </Border>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <!--  Unit Price Column  -->
                                            <DataGridTemplateColumn Width="140" Header="UNIT PRICE">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock VerticalAlignment="Center"
                                                                   FontFamily="Consolas"
                                                                   FontSize="14"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                                   Text="{Binding UnitPrice, StringFormat='${0:N2}'}" />
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <!--  Total Price Column  -->
                                            <DataGridTemplateColumn Width="160" Header="TOTAL">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Border Padding="12,6"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center"
                                                                Background="#ECFDF5"
                                                                CornerRadius="6">
                                                            <TextBlock FontFamily="Consolas"
                                                                       FontSize="15"
                                                                       FontWeight="Bold"
                                                                       Foreground="#065F46"
                                                                       Text="{Binding TotalPrice, StringFormat='${0:N2}'}" />
                                                        </Border>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>

                                <!--  Empty State  -->
                                <Border Margin="0,15,0,0"
                                        Padding="30"
                                        Background="#F8FAFC"
                                        CornerRadius="8"
                                        Visibility="{Binding HasOrderItems, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                    <StackPanel HorizontalAlignment="Center">
                                        <iconPacks:PackIconMaterial Width="48"
                                                                    Height="48"
                                                                    HorizontalAlignment="Center"
                                                                    Foreground="#94A3B8"
                                                                    Kind="PackageVariantClosedRemove" />
                                        <TextBlock Margin="0,10,0,0"
                                                   HorizontalAlignment="Center"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="No items in this order" />
                                    </StackPanel>
                                </Border>

                                <!--  Order Summary  -->
                                <Border Margin="0,15,0,0"
                                        Padding="20"
                                        Background="#F8FAFC"
                                        BorderBrush="#E2E8F0"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Visibility="{Binding HasOrderItems, Converter={StaticResource ToVisibilityConverter}}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!--  Subtotal  -->
                                        <TextBlock Grid.Row="0"
                                                   Grid.Column="0"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource SecondaryTextColor}"
                                                   Text="Subtotal:" />
                                        <TextBlock Grid.Row="0"
                                                   Grid.Column="1"
                                                   FontFamily="Consolas"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="{Binding OrderSubtotal, StringFormat='${0:N2}'}" />

                                        <!--  Divider  -->
                                        <Rectangle Grid.Row="1"
                                                   Grid.Column="0"
                                                   Grid.ColumnSpan="2"
                                                   Height="1"
                                                   Margin="0,10"
                                                   Fill="#CBD5E1" />

                                        <!--  Total  -->
                                        <TextBlock Grid.Row="2"
                                                   Grid.Column="0"
                                                   FontSize="18"
                                                   FontWeight="Bold"
                                                   Foreground="{DynamicResource PrimaryTextColor}"
                                                   Text="Total Amount:" />
                                        <TextBlock Grid.Row="2"
                                                   Grid.Column="1"
                                                   FontFamily="Consolas"
                                                   FontSize="20"
                                                   FontWeight="Bold"
                                                   Foreground="#10B981"
                                                   Text="{Binding OrderTotal, StringFormat='${0:N2}'}" />
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </Border>

                    </StackPanel>
                </ScrollViewer>

                <!--  Footer Buttons  -->
                <Grid Grid.Row="2" Margin="0,25,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--  Edit Button  -->
                    <Button Grid.Column="0"
                            Width="140"
                            Height="40"
                            HorizontalAlignment="Left"
                            Command="{Binding EditOrderCommand}"
                            Style="{DynamicResource EditBtn}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Width="16"
                                                        Height="16"
                                                        VerticalAlignment="Center"
                                                        Kind="PencilOutline" />
                            <TextBlock Margin="8,0,0,0"
                                       VerticalAlignment="Center"
                                       FontSize="13"
                                       Text="Edit Order" />
                        </StackPanel>
                    </Button>

                    <!--  Print Button  -->
                    <Button Grid.Column="1"
                            Width="130"
                            Height="42"
                            Margin="0,0,10,0"
                            Command="{Binding PrintDetailsCommand}"
                            Style="{DynamicResource OpenBtn}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Width="18"
                                                        Height="18"
                                                        VerticalAlignment="Center"
                                                        Kind="PrinterOutline" />
                            <TextBlock Margin="8,0,0,0"
                                       VerticalAlignment="Center"
                                       FontSize="14"
                                       Text="Print" />
                        </StackPanel>
                    </Button>

                    <!--  Close Button  -->
                    <Button Grid.Column="2"
                            Width="130"
                            Height="42"
                            Command="{Binding CloseCommand}"
                            Style="{DynamicResource CreateBtn}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Width="18"
                                                        Height="18"
                                                        VerticalAlignment="Center"
                                                        Kind="Check" />
                            <TextBlock Margin="8,0,0,0"
                                       VerticalAlignment="Center"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       Text="Close" />
                        </StackPanel>
                    </Button>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</views:MvxWpfView>